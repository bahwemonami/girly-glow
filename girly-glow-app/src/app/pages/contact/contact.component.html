<!-- Header -->
<section class="page-header" [style.background-image]="'url(' + headerImage + ')'">
  <div class="container">
    <h1><span class="text-gradient">Contact</span> & Rendez-vous</h1>
    <p>Nous sommes là pour répondre à toutes vos questions</p>
  </div>
</section>

<!-- Contact Info -->
<section class="contact-info section">
  <div class="container">
    <div class="info-grid">
      <!-- Address Card -->
      <div class="info-card">
        <span class="info-icon">
          <app-icon name="location" size="lg" />
        </span>
        <h3>Adresse</h3>
        <p>{{ salonInfo.address.street }}</p>
        <p>{{ salonInfo.address.postalCode }} {{ salonInfo.address.city }}</p>
        <button class="copy-btn" (click)="copyToClipboard('31 rue du Borrego, 75020 Paris')">
          <app-icon name="copy" size="sm" /> Copier
        </button>
      </div>

      <!-- Phone Card -->
      <div class="info-card">
        <span class="info-icon">
          <app-icon name="phone" size="lg" />
        </span>
        <h3>Téléphone</h3>
        @for (phone of salonInfo.phones; track phone) {
          <p>
            <a [href]="'tel:' + formatPhoneForTel(phone)">{{ phone }}</a>
          </p>
        }
        <button class="copy-btn" (click)="copyToClipboard('01 72 38 10 04')">
          <app-icon name="copy" size="sm" /> Copier
        </button>
      </div>

      <!-- Email Card -->
      <div class="info-card">
        <span class="info-icon">
          <app-icon name="mail" size="lg" />
        </span>
        <h3>Email</h3>
        <p>
          <a [href]="'mailto:' + salonInfo.email">{{ salonInfo.email }}</a>
        </p>
        <button class="copy-btn" (click)="copyToClipboard(salonInfo.email)">
          <app-icon name="copy" size="sm" /> Copier
        </button>
      </div>

      <!-- Hours Card -->
      <div class="info-card">
        <span class="info-icon">
          <app-icon name="clock" size="lg" />
        </span>
        <h3>Horaires</h3>
        <p class="hours">{{ salonInfo.hours.days }}</p>
        <p class="hours-time">{{ salonInfo.hours.open }} - {{ salonInfo.hours.close }}</p>
        <p class="hours-note">Sans rendez-vous ou avec rendez-vous</p>
      </div>
    </div>

    <!-- Metro Info -->
    <div class="metro-info">
      <span class="metro-icon">
        <app-icon name="metro" size="lg" />
      </span>
      <div class="metro-lines">
        @for (metro of salonInfo.metro; track metro) {
          <span class="metro-line">Métro {{ metro }}</span>
        }
      </div>
    </div>
  </div>
</section>

<!-- Map & Form -->
<section class="map-form section">
  <div class="container">
    <div class="map-form-grid">
      <!-- Map -->
      <div class="map-container">
        <h2>Nous trouver</h2>
        <div class="map-wrapper">
          <iframe 
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2623.7!2d2.4012!3d48.8738!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47e66d9b8f8f8f8f%3A0x0!2s31%20Rue%20du%20Borrego%2C%2075020%20Paris!5e0!3m2!1sfr!2sfr!4v1"
            width="100%"
            height="400"
            style="border:0;"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
            title="Localisation Girly Glow"
          ></iframe>
        </div>
        <a 
          href="https://www.google.com/maps/dir/?api=1&destination=31+Rue+du+Borrego,+75020+Paris"
          target="_blank"
          rel="noopener noreferrer"
          class="directions-btn"
        >
          <app-icon name="directions" size="md" /> Obtenir l'itinéraire
        </a>
      </div>

      <!-- Contact Form -->
      <div class="form-container">
        <h2>Demande de rendez-vous</h2>
        
        @if (isSubmitted()) {
          <div class="success-message">
            <span class="success-icon">
              <app-icon name="check" size="xl" />
            </span>
            <h3>Message envoyé !</h3>
            <p>Nous vous recontacterons dans les plus brefs délais.</p>
            <button class="btn-primary" (click)="isSubmitted.set(false)">
              Nouvelle demande
            </button>
          </div>
        } @else {
          <form [formGroup]="contactForm" (ngSubmit)="onSubmit()">
            <div class="form-group">
              <label for="name">Nom complet *</label>
              <input 
                type="text" 
                id="name" 
                formControlName="name"
                placeholder="Votre nom"
                [class.error]="f['name'].invalid && f['name'].touched"
              />
              @if (f['name'].invalid && f['name'].touched) {
                <span class="error-message">Le nom est requis (min. 2 caractères)</span>
              }
            </div>

            <div class="form-group">
              <label for="phone">Téléphone *</label>
              <input 
                type="tel" 
                id="phone" 
                formControlName="phone"
                placeholder="06 XX XX XX XX"
                [class.error]="f['phone'].invalid && f['phone'].touched"
              />
              @if (f['phone'].invalid && f['phone'].touched) {
                <span class="error-message">Numéro de téléphone invalide</span>
              }
            </div>

            <div class="form-group">
              <label for="email">Email (optionnel)</label>
              <input 
                type="email" 
                id="email" 
                formControlName="email"
                placeholder="votre@email.com"
                [class.error]="f['email'].invalid && f['email'].touched"
              />
              @if (f['email'].invalid && f['email'].touched) {
                <span class="error-message">Email invalide</span>
              }
            </div>

            <div class="form-group">
              <label for="service">Prestation souhaitée</label>
              <select id="service" formControlName="service">
                <option value="">Sélectionnez une prestation</option>
                @for (service of services; track service) {
                  <option [value]="service">{{ service }}</option>
                }
              </select>
            </div>

            <div class="form-group">
              <label for="message">Message *</label>
              <textarea 
                id="message" 
                formControlName="message"
                rows="4"
                placeholder="Décrivez votre demande..."
                [class.error]="f['message'].invalid && f['message'].touched"
              ></textarea>
              @if (f['message'].invalid && f['message'].touched) {
                <span class="error-message">Le message est requis (min. 10 caractères)</span>
              }
            </div>

            <button 
              type="submit" 
              class="btn-primary submit-btn"
              [disabled]="isSubmitting()"
            >
              @if (isSubmitting()) {
                <span class="loading">Envoi en cours...</span>
              } @else {
                <span>Envoyer ma demande</span>
              }
            </button>
          </form>
        }
      </div>
    </div>
  </div>
</section>

<!-- CTA -->
<section class="cta-section">
  <div class="container">
    <div class="cta-content">
      <h2>Préférez-vous appeler ?</h2>
      <p>Nous sommes disponibles 7j/7 de 10h à 20h</p>
      <div class="cta-buttons">
        <a href="tel:0172381004" class="btn-primary btn-large">
          <app-icon name="phone" size="md" />
          01 72 38 10 04
        </a>
        <a href="tel:0605904101" class="btn-secondary btn-large">
          <app-icon name="mobile" size="md" />
          06 05 90 41 01
        </a>
      </div>
    </div>
  </div>
</section>
